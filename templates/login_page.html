<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Login</title>
    <style>
      body { margin: 20px; font-family: Arial, sans-serif; }
      .wrap { max-width: 560px; }
      .card { padding: 10px 0; }
      .top a { margin-right: 10px; color: #0b57d0; }
      .group { margin: 10px 0; display: grid; gap: 6px; }
      input { padding: 8px; border: 1px solid #aaa; }
      button { padding: 8px 12px; cursor: pointer; }
      .error { color: #b00020; margin-top: 10px; }
      .ok { color: #0a6b2d; margin-top: 10px; }
    </style>
  </head>
  <body>
    <div class="wrap">
      <div class="card">
        <div class="top">
          <a href="/">Home</a>
          <a href="/register">Register</a>
          <a href="/about">About</a>
        </div>
        <h2>Login</h2>
        <form id="loginForm">
          <div class="group">
            <label>Username</label>
            <input id="username" name="username" type="text" />
          </div>
          <div class="group">
            <label>Password</label>
            <input id="password" name="password" type="password" />
          </div>
          <button type="submit">Login</button>
          <p id="msg"></p>
        </form>
      </div>
    </div>
    <script>
      const form = document.getElementById("loginForm");
      const msg = document.getElementById("msg");
      form.addEventListener("submit", async (e) => {
        e.preventDefault();
        msg.className = "";
        msg.textContent = "";
        const payload = {
          username: document.getElementById("username").value.trim(),
          password: document.getElementById("password").value
        };
        const res = await fetch("/api/login/", {
          method: "POST",
          headers: {"Content-Type": "application/json"},
          body: JSON.stringify(payload)
        });
        const data = await res.json();
        if (!res.ok) {
          msg.className = "error";
          msg.textContent = data.message || "Login failed";
          return;
        }
        msg.className = "ok";
        msg.textContent = "Login successful";
        setTimeout(() => window.location.href = "/dashboard", 700);
      });
    </script>
  </body>
  </html>
